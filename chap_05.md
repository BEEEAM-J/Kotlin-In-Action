ëŒë‹¤ëŠ” ë‹¤ë¥¸ í•¨ìˆ˜ì— ë„˜ê¸¸ ìˆ˜ ìˆëŠ” ì‘ì€ ì½”ë“œ ì¡°ê°ì„ ì˜ë¯¸í•œë‹¤. ì»¬ë ‰ì…˜ ì²˜ë¦¬ë¥¼ í•  ë•Œ ëŒë‹¤ê°€ ìì£¼ ì‚¬ìš©ëœë‹¤. 

## 5.1 ëŒë‹¤ ì‹ê³¼ ë©¤ë²„ ì°¸ì¡°

### 5.1.1 ëŒë‹¤ ì†Œê°œ: ì½”ë“œ ë¸”ë¡ì„ í•¨ìˆ˜ ì¸ìë¡œ ë„˜ê¸°ê¸°

ëŒë‹¤ ì‹ì„ ì‚¬ìš©í•˜ë©´ ì½”ë“œ ë¸”ë¡ì„ ì§ì ‘ í•¨ìˆ˜ì˜ ì¸ìë¡œ ë„˜ê¸¸ ìˆ˜ ìˆë‹¤. Listenerë¥¼ ëŒë‹¤ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

```kotlin
button.setOnClickListener { /* í´ë¦­ ì‹œ ìˆ˜í–‰í•  ë™ì‘ */ }
```

### 5.1.2 ëŒë‹¤ì™€ ì»¬ë ‰ì…˜

```kotlin
fun findTheOldest(people: List<Person>) {
    var maxAge = 0
    var theOldest: Person? = null
    for (person in people) {
        if (person.age > maxAge) {
            maxAge = person.age
            theOldest = person
        }
    }
    println(theOldest)
}
```

ìœ„ì˜ í•¨ìˆ˜ëŠ” ì»¬ë ‰ì…˜ì„ ì§ì ‘ ê²€ìƒ‰í•˜ëŠ” ë™ì‘ì„ í•œë‹¤. ê·¼ë° ì½”í‹€ë¦°ì—ì„œëŠ” ìœ„ì˜ í•¨ìˆ˜ë¥¼ ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤. 

```kotlin
println(people.maxBy { it.age })
println(people.maxBy(Person::age))

// ì‹¤í–‰ ê²°ê³¼
// Person(name=ì‚¬ì, age=30)
// Person(name=ì‚¬ì, age=30)
```

ìœ„ì™€ ê°™ì´ maxBy í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤. ëª¨ë“  ì»¬ë ‰ì…˜ì— ëŒ€í•´ì„œ maxBy í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

ì¤‘ê´„í˜¸ ì•ˆì— ì½”ë“œëŠ” ë¹„êµì— ì‚¬ìš©í•  ê°’ì„ ë°˜í™˜í•´ì£¼ëŠ” í•¨ìˆ˜ì¸ë° ì´ì²˜ëŸ¼ í•¨ìˆ˜ë‚˜ í”„ë¡œí¼í‹°ë¥¼ ë°˜í™˜í•˜ëŠ” ì—­í• ì„ í•˜ëŠ” í•¨ë‹¤ëŠ” ë©¤ë²„ ì°¸ì¡°ë¡œ ëŒ€ì¹˜í•  ìˆ˜ ìˆë‹¤. 

### 5.1.3 ëŒë‹¤ ì‹ì˜ ë¬¸ë²•

ëŒë‹¤ëŠ” ê°’ì„ ì „ë‹¬í•  ìˆ˜ ìˆëŠ” ë™ì‘ì˜ ëª¨ìŒì´ë‹¤. ë”°ë¡œ ì„ ì–¸í•´ì„œ ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤. 

ì½”í‹€ë¦° ëŒë‹¤ ì‹ì€ í•­ìƒ ì¤‘ê´„í˜¸ ì•ˆì— ë“¤ì–´ìˆê³ , í™”ì‚´í‘œ(â†’)ê°€ ì¸ìì™€ ë³¸ë¬¸ì„ êµ¬ë¶„í•´ì¤€ë‹¤.

```kotlin
{ x: Int, y: Int -> x + y }
//       ì¸ì        ë³¸ë¬¸
```

ëŒë‹¤ ì‹ì€ ë³€ìˆ˜ì— ì €ì¥í•  ìˆ˜ ìˆë‹¤. ì›í•˜ë©´ ëŒë‹¤ ì‹ì„ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.

```kotlin
val sum = { x: Int, y: Int -> x + y }       // ëŒë‹¤ ì‹ì„ ë³€ìˆ˜ì— ì €ì¥
println(sum(1, 2))
    
{ println(43) } ()                          // ëŒë‹¤ ì‹ì„ ì§ì ‘ í˜¸ì¶œ
```

ì½”ë“œ ì¼ë¶€ë¶„ì„ ë¸”ë¡ìœ¼ë¡œ ê°ì‹¸ì„œ ì‹¤í–‰í•  í•„ìš”ê°€ ìˆëŠ” ê²½ìš°ì—ëŠ” runì„ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤. runì€ ì¸ìë¡œ ë°›ì€ ëŒë‹¤ë¥¼ ì‹¤í–‰í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤. 

```kotlin
run { println(43) }                         // runìœ¼ë¡œ ëŒë‹¤ ë³¸ë¬¸ì˜ ì½”ë“œ ì‹¤í–‰
```

ìœ„ì—ì„œ ì„¤ëª…í–ˆë˜ maxBy í•¨ìˆ˜ì˜ ì˜ˆì‹œë¥¼ ì •ì‹ ëŒë‹¤ë¡œ ì‘ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. 

```kotlin
people.maxBy({ p: Person -> p.age })
people.maxBy() { p: Person -> p.age }  // ë§¨ ë’¤ì˜ ì¸ìê°€ ëŒë‹¤ë¼ì„œ ëŒë‹¤ë¥¼ ê´„í˜¸ ë°–ìœ¼ë¡œ ëºŒ
people.maxBy { p: Person -> p.age }  
// ëŒë‹¤ê°€ í•¨ìˆ˜ì˜ ìœ ì¼í•œ ì¸ì, ê´„í˜¸ ë’¤ì— ëŒë‹¤ ì‘ì„±í•´ì„œ ë¹ˆ ê´„í˜¸ ì œê±°
```

ìœ„ì˜ 3ì¤„ì˜ ì½”ë“œëŠ” ì•½ê°„ì€ ë‹¤ë¥¸ í˜•ì‹ì„ ê°€ì§€ê³  ìˆì§€ë§Œ ëª¨ë‘ ê°™ì€ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤. 

ì½”í‹€ë¦°ì—ëŠ” í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ë§¨ ë’¤ì— ìˆëŠ” ì¸ìê°€ ëŒë‹¤ì´ë©´ ê·¸ ëŒë‹¤ë¥¼ ê´„í˜¸ ë°–ìœ¼ë¡œ ë¹¼ë‚¼ ìˆ˜ ìˆëŠ” ë¬¸ë²• ê´€ìŠµì´ ìˆë‹¤. ê·¼ë° ëŒë‹¤ê°€ í•¨ìˆ˜ì˜ ìœ ì¼í•œ ì¸ìì´ê³ , ê´„í˜¸ ë’¤ì— ëŒë‹¤ë¥¼ ì‘ì„±í–ˆë‹¤ë©´ ë¹ˆ ê´„í˜¸ëŠ” ì œê±°í•´ë„ ëœë‹¤.

```kotlin
people.maxBy { p -> p.age }
```

ë¡œì»¬ ë³€ìˆ˜ì²˜ëŸ¼ ëŒë‹¤ íŒŒë¼ë¯¸í„°ë„ ì»´íŒŒì¼ëŸ¬ê°€ ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ë‹¤. ê·¼ë° ì»´íŒŒì¼ëŸ¬ê°€ ì¶”ë¡ ì„ ëª»í•˜ëŠ” ê²½ìš°ë„ ìˆëŠ”ë° ì´ëŸ´ ë• ê·¸ëƒ¥ íƒ€ì…ì„ ëª…ì‹œí•´ì£¼ë©´ ëœë‹¤!

```kotlin
people.maxBy { it.age }
```

ëŒë‹¤ì˜ íŒŒë¼ë¯¸í„°ê°€ í•˜ë‚˜ë¿ì´ê³   ê·¸ íƒ€ì…ì„ ì»´íŒŒì¼ëŸ¬ê°€ ì¶”ë¡ í•  ìˆ˜ ìˆëŠ” ê²½ìš°ì—ëŠ” itì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë©´ ë” ê°„ë‹¨í•œ ëŒë‹¤ ì‹ì„ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

ëŒë‹¤ë¥¼ ë³€ìˆ˜ì— ì €ì¥í•  ë•ŒëŠ” íŒŒë¼ë¯¸í„°ì˜ íƒ€ì…ì„ ì¶”ë¡ í•  ë¬¸ë§¥ì´ ì—†ì–´ì„œ íƒ€ì…ì„ ê¼­ ëª…ì‹œí•´ì•¼ í•œë‹¤. 

```kotlin
val sum1 = { x: Int, y: Int ->
        println("sum1 ì‹¤í–‰!")
        x + y
}
```

ìœ„ì²˜ëŸ¼ ë³¸ë¬¸ì´ ì—¬ëŸ¬ ì¤„ì¸ ëŒë‹¤ì—ì„œëŠ” ë§ˆì§€ë§‰ ì¤„ì´ ê²°ê³¼ê°€ ëœë‹¤. 

### 5.1.4 í˜„ì¬ ì˜ì—­ì— ìˆëŠ” ë³€ìˆ˜ì— ì ‘ê·¼

ëŒë‹¤ë¥¼ í•¨ìˆ˜ ì•ˆì—ì„œ ì •ì˜í•˜ë©´ í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ë¿ ì•„ë‹ˆë¼ ëŒë‹¤ ì •ì˜ì˜ ì•ì— ì„ ì–¸ëœ ë¡œì»¬ ë³€ìˆ˜ê¹Œì§€ ëŒë‹¤ì—ì„œ ëª¨ë‘ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 

ê·¸ë¦¬ê³  ì½”í‹€ë¦° ëŒë‹¤ì—ì„œëŠ” íŒŒì´ë„ ë³€ìˆ˜ê°€ ì•„ë‹Œ ë³€ìˆ˜ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ê³  ëŒë‹¤ ë°”ê¹¥ì˜ ë³€ìˆ˜ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤. 

ëŒë‹¤ ì‹ ì•ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” ì™¸ë¶€ ë³€ìˆ˜ë¥¼ **ëŒë‹¤ê°€ í¬íší•œ ë³€ìˆ˜**ë¼ê³  ë¶€ë¥¸ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ  í•¨ìˆ˜ ì•ˆì— ì •ì˜ëœ ë¡œì»¬ ë³€ìˆ˜ëŠ” í•¨ìˆ˜ì™€ ê°™ì€ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§„ë‹¤. ê·¼ë° ì–´ë–¤ í•¨ìˆ˜ê°€ ìì‹ ì˜ ë¡œì»¬ ë³€ìˆ˜ë¥¼ í¬íší•œ ëŒë‹¤ë¥¼ ë°˜í™˜í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë³€ìˆ˜ì— ì €ì¥í•˜ë©´ ë¡œì»¬ ë³€ìˆ˜ì˜ ìƒëª…ì£¼ê¸°ê°€ í•¨ìˆ˜ì˜ ìƒëª…ì£¼ê¸°ì™€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤. í•¨ìˆ˜ê°€ ëë‚œ ë’¤ì— ì‹¤í–‰í•´ë„ ëŒë‹¤ ë³¸ë¬¸ì˜ ì½”ë“œëŠ” í¬íší•œ ë³€ìˆ˜ë¥¼ ì½ê±°ë‚˜ ì“¸ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ ëŒë‹¤ë¥¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë‚˜ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œë¡œ í™œìš©í•˜ëŠ” ê²½ìš° í•¨ìˆ˜ í˜¸ì¶œì´ ëë‚œ ë‹¤ìŒì— ë¡œì»¬ ë³€ìˆ˜ê°€ ë³€ê²½ë  ìˆ˜ ìˆë‹¤.

```kotlin
fun tryToCountButtonClicks(button: Button): Int {
    var clicks = 0
    button.onClick { clicks ++ }
    return clicks
}
```

ìœ„ì˜ í•¨ìˆ˜ëŠ” í•­ìƒ 0ì„ ë°˜í™˜í•˜ëŠ”ë° ì´ëŠ” í•¸ë“¤ëŸ¬ëŠ” tryToCountButtonClicksê°€ clicksë¥¼ ë°˜í™˜í•œ ë‹¤ìŒì— í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì´ë‹¤. 

### 5.1.5 ë©¤ë²„ ì°¸ì¡°

ì½”í‹€ë¦°ì€ ìë°”ì²˜ëŸ¼ í•¨ìˆ˜ë¥¼ ê°’ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆëŠ”ë° ì´ì¤‘ ì½œë¡ (::)ì„ ì‚¬ìš©í•œë‹¤. ì´ë¥¼ ë©¤ë²„ ì°¸ì¡°ë¼ê³  ë¶€ë¥¸ë‹¤. ë©¤ë²„ ì°¸ì¡°ëŠ” í”„ë¡œí¼ë‹ˆë‚˜ ë©”ì„œë“œë¥¼ ë‹¨ í•˜ë‚˜ë§Œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ ê°’ì„ ë§Œë“¤ì–´ì¤€ë‹¤. 

```kotlin
Person::age
// í´ë˜ìŠ¤::ë©¤ë²„

person: Person -> person.age // Person::age ì™€ ë™ì¼í•œ ì˜ë¯¸

fun salute() = println("Salute!")
run(::salute)                // ìµœìƒìœ„ í•¨ìˆ˜ ì°¸ì¡°ë„ ê°€ëŠ¥
```

ëŒë‹¤ê°€ ì¸ìê°€ ì—¬ëŸ¿ì¸ ë‹¤ë¥¸ í•¨ìˆ˜ì— ì‘ì—…ì„ ìœ„ì„í•˜ëŠ” ê²½ìš° ëŒë‹¤ë¥¼ ì •ì˜í•˜ì§€ ì•Šê³  ì§ì ‘ ìœ„ì„ í•¨ìˆ˜ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ì œê³µí•˜ë©´ í¸ë¦¬í•˜ë‹¤.

```kotlin
val action = { msg: Collection<String>, prefix: String ->
        printMessageWitjPrefix(msg, prefix)
    }

val nextAction = ::printMessageWitjPrefix
println(nextAction(errors, "Errors:"))
```

ìƒì„±ì ì°¸ì¡°ë¥¼ ì‚¬ìš©í•˜ë©´ í´ë˜ìŠ¤ ìƒì„± ì‘ì—…ì„ ì—°ê¸°í•˜ê±°ë‚˜ ì €ì¥í•´ ë†“ì„ ìˆ˜ ìˆë‹¤. ì´ì¤‘ ì½œë¡  ë’¤ì— í´ë˜ìŠ¤ ì´ë¦„ì„ ë¶™ì´ë©´ ìƒì„±ì ì°¸ì¡°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤. 

```kotlin
val createPerson = ::Person        // Person ì¸ìŠ¤í„´ìŠ¤ ë§Œë“œëŠ” ë™ì‘ì„ ê°’ìœ¼ë¡œ ì €ì¥
val p = createPerson("ë²”ì¤€", 25)
println(p)
```

## 5.2 ì»¬ë ‰ì…˜ í•¨ìˆ˜í˜• API

í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•˜ë©´ ì»¬ë ‰ì…˜ ì²˜ë¦¬ë¥¼ í•  ë•Œ í¸í•˜ë‹¤. ëŒ€ë¶€ë¶„ì˜ ì‘ì—…ì— ë¼ì´ë¸ŒëŸ¬ë¦¬ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³ , ì´ë¡œ ì¸í•´ ì½”ë“œë¥¼ ë” ê°„ê²°í•˜ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

### 5.2.1 í•„ìˆ˜ì ì¸ í•¨ìˆ˜: filterì™€ map

filter í•¨ìˆ˜ëŠ” ì»¬ë ‰ì…˜ì„ ëŒë©´ì„œ ì£¼ì–´ì§„ ëŒë‹¤ì— ê° ì›ì†Œë¥¼ ë„˜ê²¨ì„œ ëŒë‹¤ê°€ trueë¥¼ ë°˜í™˜í•˜ëŠ” ì›ì†Œë§Œ ëª¨ì€ë‹¤.

```kotlin
val list = listOf(1, 2, 3, 4)
println(list.filter { it % 2 == 0 })      // ì§ìˆ˜ë§Œ ë°˜í™˜
```

filter í•¨ìˆ˜ëŠ” ì›í•˜ì§€ ì•ŠëŠ” ì›ì†Œë“¤ì„ ì»¬ë ‰ì…˜ì—ì„œ ì œê±°í•œë‹¤. í•˜ì§€ë§Œ filterëŠ” ì›ì†Œë¥¼ ë°˜í™˜í•  ìˆ˜ëŠ” ì—†ë‹¤. ì›ì†Œë¥¼ ë°˜í™˜í•˜ë ¤ë©´ map í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤. 

map í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ ëŒë‹¤ë¥¼ ì»¬ë ‰ì…˜ì˜ ê° ì›ì†Œì— ì ìš©í•˜ì—¬ ìƒˆ ì»¬ë ‰ì…˜ì„ ë§Œë“ ë‹¤. 

```kotlin
val list = listOf(1, 2, 3, 4)
println(list.map { it * it })     // ê° ì›ì†Œì— ì œê³±ëœ ì»¬ë ‰ì…˜
```

```kotlin
val people = listOf(Person("ê³°", 20), Person("ì‚¬ì", 30))
println(people.map { it.name })    // ê° ì›ì†Œì˜ ì´ë¦„ë§Œ ê°–ëŠ” ì»¬ë ‰ì…˜
println(people.map(Person::name))  // ë©¤ë²„ ì°¸ì¡° ì‚¬ìš©í•´ì„œë„ ë§Œë“¤ ìˆ˜ ìˆìŒ!

// ì‹¤í–‰ ê²°ê³¼
// [ê³°, ì‚¬ì]
// [ê³°, ì‚¬ì]
```

í•„í„°ì™€ ë³€í™˜ í•¨ìˆ˜ëŠ” mapì—ë„ ì ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.

map ì˜ ê²½ìš° í‚¤ì™€ ê°’ì„ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ê°€ ë”°ë¡œ ì¡´ì¬í•œë‹¤. filterKeysì™€ mapKeysëŠ” í‚¤ë¥¼ ê±¸ëŸ¬ë‚´ê±°ë‚˜ ë³€í™˜í•˜ê³ , filterValuesì™€ mapValuesëŠ” ê°’ì„ ê±¸ëŸ¬ë‚´ê±°ë‚˜ ë³€í™˜í•œë‹¤.

### 5.2.2 all, any, count, find: ì»¬ë ‰ì…˜ì— ìˆ ì–´ ì ìš©

all, any í•¨ìˆ˜ëŠ” ì»¬ë ‰ì…˜ì˜ ì›ì†Œê°€ ëª¨ë‘ ì¡°ê±´ì— ë§Œì¡±í•˜ëŠ”ì§€ ë˜ëŠ” í•˜ë‚˜ë¼ë„ ì¡°ê±´ì— ë§Œì¡±í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ”ë° ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

count í•¨ìˆ˜ëŠ” ìˆ ì–´ë¥¼ ë§Œì¡±í•˜ëŠ” ì›ì†Œì˜ ê°œìˆ˜ë¥¼ í™•ì¸í•  ë•Œ ì‚¬ìš©í•˜ê³ , ìˆ ì–´ë¥¼ ë§Œì¡±í•˜ëŠ” ì›ì†Œë¥¼ ì°¾ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ” find í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.

find í•¨ìˆ˜ëŠ” **ê°€ì¥ ë¨¼ì € ì¡°ê±´ì´ ë§Œì¡±ëœë‹¤ê³  í™•ì¸ ëœ ì›ì†Œë¥¼ ë°˜í™˜**í•œë‹¤. ê·¸ë˜ì„œ 2ê°œ ì´ìƒì˜ ì›ì†Œê°€ ì¡°ê±´ì„ ë§Œì¡±í•´ë„ í•œ ì›ì†Œë§Œ ë°˜í™˜í•œë‹¤.

```kotlin
val canBeInClub27 = { p: Person -> p.age <= 27 }  // ì¡°ê±´: ë‚˜ì´ê°€ 27 ì´í•˜
val people = listOf(Person("ê³°", 20), Person("ì‚¬ì", 30))
println(people.all(canBeInClub27))                // ì‚¬ìê°€ 27 ì´ìƒì´ë¼ì„œ false
println(people.any(canBeInClub27))                // ê³°ì´ ì¡°ê±´ì„ ë§Œì¡±í•´ì„œ true
println(people.count(canBeInClub27))              // ê³°ë§Œ ì¡°ê±´ ë§Œì¡±í•´ì„œ 1
println(people.find(canBeInClub27))               // ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê±´ ê³°ì´ë¼ì„œ ê³°ì˜ ì •ë³´ ì¶œë ¥
```

### 5.2.3 groupBy: ë¦¬ìŠ¤íŠ¸ë¥¼ ì—¬ëŸ¬ ê·¸ë£¹ìœ¼ë¡œ ì´ë¤„ì§„ ë§µìœ¼ë¡œ ë³€ê²½

groupBy í•¨ìˆ˜ëŠ” ì»¬ë ‰ì…˜ì˜ ëª¨ë“  ì›ì†Œë¥¼ ì›í•˜ëŠ” ê¸°ì¤€ì— ë”°ë¼ì„œ ì—¬ëŸ¬ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆŒ ë•Œ ì‚¬ìš©ëœë‹¤.

ì—°ì‚°ì˜ ê²°ê³¼ëŠ” ì›í•˜ëŠ” ê¸°ì¤€ì„ í‚¤ë¡œ ê°–ê³ , ì»¬ë ‰ì…˜ì˜ ì›ì†Œë“¤ì„ ê°’ìœ¼ë¡œ ê°–ëŠ” map í˜•ì‹ì´ë‹¤.

```kotlin
val people = listOf(
    Person("ê³°", 20),
    Person("ì‚¬ì", 30),
    Person("ì—¬ìš°", 30),
    Person("í˜¸ë‘ì´", 40)
)
println(people.groupBy { it.age })

// ì‹¤í–‰ ê²°ê³¼
// {20=[Person(name=ê³°, age=20)], 30=[Person(name=ì‚¬ì, age=30), Person(name=ì—¬ìš°, age=30)], 40=[Person(name=í˜¸ë‘ì´, age=40)]}
```

### 5.2.4 flatMapê³¼ flatten: ì¤‘ì²©ëœ ì»¬ë ‰ì…˜ ì•ˆì˜ ì›ì†Œ ì²˜ë¦¬

flatMap í•¨ìˆ˜ëŠ” ì¸ìë¡œ ì£¼ì–´ì§„ ëŒë‹¤ë¥¼ ì»¬ë ‰ì…˜ì˜ ëª¨ë“  ê°ì²´ì— ì ìš©í•˜ê³  ëŒë‹¤ë¥¼ ì ìš©í•œ ê²°ê³¼ ì–»ì–´ì§€ëŠ” ì—¬ëŸ¬ ë¦¬ìŠ¤íŠ¸ë¥¼ í•œ ë¦¬ìŠ¤íŠ¸ë¡œ í•œë° ëª¨ì€ë‹¤. 

```kotlin
val books = listOf(
    Book("ì–´ë¦° ì™•ì", listOf("ë­ì‹œê¸°")),
    Book("ëª¨ë¹„ë”•", listOf("ì™¸êµ­ ì‚¬ëŒ")),
    Book("ëˆ„êµ°ê°€ì˜ ìì„œì „", listOf("ì™¸êµ­ ì‚¬ëŒ")),
    Book("ì½”í‹€ë¦° ì¸ ì•¡ì…˜", listOf("ë“œë¯¸íŠ¸ë¦¬"))
)
println(books.flatMap { it.authors }.toSet())

// ì‹¤í–‰ ê²°ê³¼
// [ë­ì‹œê¸°, ì™¸êµ­ ì‚¬ëŒ, ë“œë¯¸íŠ¸ë¦¬]
```

flatMap í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ì±…ì˜ ì €ìë“¤ì´ ì›ì†Œë¡œ ìˆëŠ” ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê³ , toSet() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¤‘ë³µì„ ì œê±°í•œ ì§‘í•©ìœ¼ë¡œ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì— ì‹¤í–‰ ê²°ê³¼ì™€ ê°™ì€ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## 5.3 ì§€ì—° ê³„ì‚°(lazy) ì»¬ë ‰ì…˜ ì—°ì‚°

ì•ì—ì„œ ë´¤ë˜ mapì´ë‚˜ filter í•¨ìˆ˜ëŠ” ê²°ê³¼ ì»¬ë ‰ì…˜ì„ ì¦‰ì‹œ ìƒì„±í•œë‹¤. ì´ëŠ” ì»¬ë ‰ì…˜ í•¨ìˆ˜ë¥¼ ì—°ì‡„í•˜ë©´ ë§¤ ë‹¨ê³„ë§ˆë‹¤ ê³„ì‚° ì¤‘ê°„ ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ ì»¬ë ‰ì…˜ì— ì„ì‹œë¡œ ë‹´ëŠ”ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ê·¼ë° ì‹œí€€ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ ì¤‘ê°„ ì„ì‹œ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì»¬ë ‰ì…˜ ì—°ì‚°ì„ ì—°ì‡„ í•  ìˆ˜ ìˆë‹¤.

```kotlin
people.map(Person::name).filter { it.startsWith("A") }
```

filterë‚˜ map í•¨ìˆ˜ëŠ” ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•œë‹¤. ì´ëŠ” ìœ„ ì˜ˆì‹œì˜ ì—°ì‡„ í˜¸ì¶œì´ ë¦¬ìŠ¤íŠ¸ë¥¼ 2ê°œ ë§Œë“ ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ì›ë³¸ ë¦¬ìŠ¤íŠ¸ì˜ ì›ì†Œê°€ ì ìœ¼ë©´ ìƒê´€ ì—†ëŠ”ë° ë§ì€ ê²½ìš°ì—ëŠ” íš¨ìœ¨ì´ ë–¨ì–´ì§€ê¸° ë•Œë¬¸ì— ì‹œí€€ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ì¢‹ë‹¤.

```kotlin
people.asSequence()     // ì›ë³¸ ì»¬ë ‰ì…˜ì„ ì‹œí€€ìŠ¤ë¡œ ë³€ê²½
    .map(Person::name)
    .filter { it.startsWith("A") }
    .toList()          // ì‹œí€€ìŠ¤ë¥¼ ë‹¤ì‹œ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€ê²½
```

ì‹œí€€ìŠ¤ì˜ ì›ì†ŒëŠ” í•„ìš”í•  ë•Œ ê³„ì‚°ëœë‹¤. ê·¸ë˜ì„œ ì¤‘ê°„ ê°’ì„ ì €ì¥í•˜ì§€ ì•Šê³  íš¨ìœ¨ì ìœ¼ë¡œ ì—°ì‚°ì„ ì—°ì‡„ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. 

> í° ì»¬ë ‰ì…˜ì— ëŒ€í•´ ì—°ì‡„ ì—°ì‚°ì„ ì²˜ë¦¬í•˜ëŠ” ê²½ìš°ì—ëŠ” ì‹œí€€ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
> 

### 5.3.1 ì‹œí€€ìŠ¤ ì—°ì‚° ì‹¤í–‰: ì¤‘ê°„ ì—°ì‚°ê³¼ ìµœì¢… ì—°ì‚°

ì‹œí€€ìŠ¤ì— ëŒ€í•œ ì—°ì‚°ì€ ì¤‘ê°„, ìµœì¢… ì—°ì‚°ìœ¼ë¡œ ë‚˜ë‰œë‹¤. ì¤‘ê°„ ì—°ì‚°ì€ ë‹¤ë¥¸ ì‹œí€€ìŠ¤ë¥¼ ë°˜í™˜í•˜ê³ , ìµœì¢… ì—°ì‚°ì€ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤. 

```kotlin
people.asSequence()     
    .map(Person::name)               // ì¤‘ê°„ ì—°ì‚°
    .filter { it.startsWith("A") }   // ì¤‘ê°„ ì—°ì‚°
    .toList()                        // ìµœì¢… ì—°ì‚°
```

ì¤‘ê°„ ì—°ì‚°ì€ í•­ìƒ ì§€ì—° ê³„ì‚°ëœë‹¤. ê·¸ë˜ì„œ ìµœì¢… ì—°ì‚°ì´ ì—†ìœ¼ë©´ ì¤‘ê°„ ì—°ì‚°ì´ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤. 

ìµœì¢… ì—°ì‚°ì´ ìˆì–´ì•¼ ì§€ì—°ë˜ì—ˆë˜ ì¤‘ê°„ ì—°ì‚°ë“¤ì´ ì‹¤í–‰ëœë‹¤.

```kotlin
people.asSequence()
    .map( Person::name)
    .filter { println("ì¤‘ê°„ ì—°ì‚° ì‹¤í–‰?"); it.startsWith("A") }
//    .toList()
```

ê·¸ë˜ì„œ ìœ„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì•„ë¬´ëŸ° ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤.

**ë‚´ìš© ì¶”ê°€ í•„ìš”!**

### 5.3.2 ì‹œí€€ìŠ¤ ë§Œë“¤ê¸°

ì§€ê¸ˆê¹Œì§€ ë³¸ ì‹œí€€ìŠ¤ ì˜ˆì œë“¤ì€ ëª¨ë‘ asSequence() í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ë§Œë“¤ì—ˆì§€ë§Œ generateSequence() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë„ ëœë‹¤.

## 5.4 ìë°” í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ í™œìš©

ì¶”ìƒ ë©”ì„œë“œê°€ í•˜ë‚˜ë§Œ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ **í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤** ë˜ëŠ” **SAM ì¸í„°í˜ì´ìŠ¤**ë¼ê³  í•œë‹¤. ì½”í‹€ë¦°ì€ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¸ìë¡œ ì·¨í•˜ëŠ” ìë°” ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ë•Œ ëŒë‹¤ë¥¼ ë„˜ê¸¸ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. ê·¸ë˜ì„œ ìë°” 8 ì´ì „ì˜ ìë°”ì—ì„œì™€ ë‹¬ë¦¬ setOnClickListenerë¥¼ ê°„ë‹¨í•˜ê²Œ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.

```kotlin
button.setOnClickListener { view -> ... }
```

### 5.4.1 ìë°” ë©”ì„œë“œì— ëŒë‹¤ë¥¼ ì¸ìë¡œ ì „ë‹¬

ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë˜ ê²ƒì²˜ëŸ¼ ì½”í‹€ë¦°ì€ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¸ìë¡œ ì›í•˜ëŠ” ìë°” ë©”ì„œë“œì— ëŒë‹¤ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ ëŒ€ì‹ í•´ì„œ ë¬´ëª… ê°ì²´ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•´ë„ ëœë‹¤. 

```kotlin
/* ìë°” */
void postponeComputation(int delay, Runnable computation);

postponeComputation(1000) { println(42) }    // ëŒë‹¤ ì „ë‹¬

postponeComputation(1000, object: Runnable {  // ë¬´ëª… ê°ì²´ ì „ë‹¬
    override fun run() {
		    println(42)                  
    }
}

fun handleComputation(id: String) {
// postponeComputation í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    postponeComputation(1000) { println(42) }   
}
```

ë¬´ëª… ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ê°€ ìƒì„±ë˜ì§€ë§Œ ëŒë‹¤ëŠ” ê°™ì€ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” ì°¨ì´ì ì´ ìˆë‹¤.

ê·¼ë° ëŒë‹¤ê°€ ì£¼ë³€ ì˜ì—­ì˜ ë³€ìˆ˜ë¥¼ í¬íší•˜ë©´ ë§¤ í˜¸ì¶œ ë•Œë§ˆë‹¤ ê°™ì€ ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ì´ëŸ° ê²½ìš° ì»´íŒŒì¼ëŸ¬ëŠ” í•´ë‹¹ ë³€ìˆ˜ë¥¼ í¬íší•œ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ì¤€ë‹¤.

### 5.4.2 SAM ìƒì„±ì: ëŒë‹¤ë¥¼ í•¨ìˆ˜í˜• ì¸ìŠ¤í„´ìŠ¤ë¡œ ëª…ì‹œì ìœ¼ë¡œ ë³€ê²½

SAM ìƒì„±ìëŠ” ëŒë‹¤ë¥¼ í•¨ìˆ˜í˜• ì¸ìŠ¤í„´ìŠ¤ë¡œ ë³€í™˜í•  ìˆ˜ ìˆê²Œ ì»´íŒŒì¼ëŸ¬ê°€ ìë™ìœ¼ë¡œ ìƒì„±í•œ í•¨ìˆ˜ë‹¤. 

```kotlin
fun createAllDoneRunnable(): Runnable {
    return Runnable { println("All done!") }
}

createAllDoneRunnable().run()
```

ìœ„ì˜ ê²½ìš°ëŠ” í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œì´ë‹¤. ê·¸ë˜ì„œ ëŒë‹¤ë¥¼ ë°˜í™˜í•  ìˆ˜ ì—†ì–´ì„œ ëŒë‹¤ë¥¼ SAM ìƒì„±ìë¡œ ê°ì‹¸ì„œ ë°˜í™˜í•˜ì˜€ë‹¤.

SAM ìƒì„±ìì˜ ì´ë¦„ì€ ì‚¬ìš©í•˜ë ¤ëŠ” í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. SAM ìƒì„±ìëŠ” ê·¸ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ì˜ ìœ ì¼í•œ ì¶”ìƒ ë©”ì„œë“œì˜ ë³¸ë¬¸ìœ¼ë¡œ ì‚¬ìš©í•  ëŒë‹¤ë§Œ ì¸ìë¡œ ë°›ì•„ì„œ ë°˜í™˜í•œë‹¤.

ëŒë‹¤ë¡œ ìƒì„±í•œ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³€ìˆ˜ì— ì €ì¥í•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ë„ SAM ìƒì„±ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì•ˆë“œë¡œì´ë“œì˜ ê²½ìš° ë§Œì•½ ì—¬ëŸ¬ ë²„íŠ¼ì— ê°™ì€ ë¦¬ìŠ¤ë„ˆë¥¼ ì ìš©í•˜ê³  ì‹¶ì€ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

```kotlin
val listener = OnClickListener { view -> 
    val text = when(view.id) {
        R.id.btn1 -> "btn1"
        R.id.btn2 -> "btn2"
        else -> "Unknown"
    }
    toast(text)
}
btn1.setOnClickListener(listener)
btn2.setOnClickListener(listener)
```

## 5.5 ìˆ˜ì‹  ê°ì²´ ì§€ì • ëŒë‹¤: withì™€ apply

ì½”í‹€ë¦°ì˜ ëŒë‹¤ëŠ” ìˆ˜ì‹  ê°ì²´ë¥¼ ëª…ì‹œí•˜ì§€ ì•Šê³  ëŒë‹¤ ë³¸ë¬¸ ì•ˆì—ì„œ ë‹¤ë¥¸ ê°ì²´ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ìë°”ì˜ ëŒë‹¤ì—ëŠ” ì—†ëŠ” ê¸°ëŠ¥ì´ë‹¤. ì´ëŸ¬í•œ ëŒë‹¤ë¥¼ ìˆ˜ì‹  ê°ì²´ ì§€ì • ëŒë‹¤ë¼ê³  ë¶€ë¥¸ë‹¤.

### 5.5.1 with í•¨ìˆ˜

with í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ì–´ë–¤ ê°ì²´ì˜ ì´ë¦„ì„ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ì„œ í•´ë‹¹ ê°ì²´ì— ëŒ€í•œ ë‹¤ì–‘í•œ ì—°ì‚°ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

```kotlin
fun alphabet(): String {
    val result = StringBuilder()
    for (letter in 'A' .. 'Z') {
        result.append(letter)
    }
    result.append("\nNow I know the alphabet!")
    return result.toString()
}
```

ìœ„ì˜ í•¨ìˆ˜ëŠ” result ë³€ìˆ˜ì— StringBuilderë¥¼ ë‹´ê³ , ì´ ë³€ìˆ˜ì— ëŒ€í•œ ë‹¤ì–‘í•œ ì—°ì‚°ì„ í•˜ê³  ìˆë‹¤. ê·¼ë° ì—¬ê¸°ì„œ with() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ë¶ˆí•„ìš”í•˜ê²Œ resultë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

```kotlin
fun alphabet() = with(StringBuilder()) {
    for (letter in 'A' .. 'Z') {
        append(letter)
    }
    append("\nNow I know the alphabet!")
    toString()
}
```

with() í•¨ìˆ˜ëŠ” ëŒë‹¤ ì‹ì˜ ë³¸ë¬¸ì— ìˆëŠ” ë§¨ ë§ˆì§€ë§‰ ì‹ì˜ ê°’ì„ ë°˜í™˜í•œë‹¤.

### 5.5.2 apply í•¨ìˆ˜

apply() í•¨ìˆ˜ëŠ” with() í•¨ìˆ˜ì™€ ê±°ì˜ ê°™ì§€ë§Œ ìœ ì¼í•œ ì°¨ì´ëŠ” apply() í•¨ìˆ˜ëŠ” í•­ìƒ ìì‹ ì—ê²Œ ì „ë‹¬ëœ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤ëŠ” ì ì´ë‹¤. 

<aside>
ğŸ’¡ withëŠ” ëŒë‹¤ì˜ ê²°ê³¼ë¥¼ ë°˜í™˜ / applyëŠ” ê°ì²´ ìì²´ë¥¼ ë°˜í™˜

</aside>

```kotlin
fun alphabet() = StringBuilder().apply {
    for (letter in 'A' .. 'Z') {
        append(letter)
    }
    append("\nNow I know the alphabet!")
}

println(alphabet().javaClass)

// ì‹¤í–‰ ê²°ê³¼
// class java.lang.StringBuilder
```

apply() í•¨ìˆ˜ëŠ” ê°ì²´ ìì²´ë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ìœ„ì˜ alphabet() í•¨ìˆ˜ì˜ ë°˜í™˜ ê°’ì˜ íƒ€ì…ì„ í™•ì¸í•´ë³´ë©´ StringBuilder ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
