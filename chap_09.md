9μ¥μ—μ„λ” **μ λ„¤λ¦­μ¤**μ™€ **μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°(reified type parameter)**, **μ„ μ–Έ μ§€μ  λ³€μ„±(declaration-site variance)** λ“±μ λ‚΄μ©μ„ λ³Ό μ μλ‹¤. 

**μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°**λ¥Ό μ‚¬μ©ν•λ©΄ μΈλΌμΈ ν•¨μ νΈμ¶μ—μ„ νƒ€μ… μΈμλ΅ μ“°μΈ κµ¬μ²΄μ μΈ νƒ€μ…μ„ μ‹¤ν–‰ μ‹μ μ—μ„ μ• μ μλ‹¤. 
(μΌλ° ν΄λμ¤λ‚ ν•¨μμ—μ„λ” νƒ€μ… μΈμ μ •λ³΄κ°€ μ‹¤ν–‰ μ‹μ μ—μ„ μ‚¬λΌμ§€κΈ° λ•λ¬Έμ— λ¶κ°€λ¥)

**μ„ μ–Έ μ§€μ • λ³€μ„±**μ„ μ‚¬μ©ν•λ©΄ κΈ°μ € νƒ€μ…μ€ κ°™μ§€λ§ νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ λ‘ μ λ„¤λ¦­ νƒ€μ… Type<A>μ™€ Type<B>κ°€ μμ„ λ• νƒ€μ… μΈμ Aμ™€ Bμ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„μ— λ”°λΌ λ‘ μ λ„¤λ¦­ νƒ€μ…μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ–΄λ–»κ² λλ”μ§€ μ§€μ •ν•  μ μλ‹¤. 
(List<Any>λ¥Ό μΈμλ΅ λ°›λ” ν•¨μμ—κ² List<Int>νƒ€μ…μ κ°’μ„ μ „λ‹¬ν•  μ μμ„μ§€ μ—¬λ¶€ μ§€μ • κ°€λ¥)

## 9.1 μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°

μ λ„¤λ‹‰μ¤λ¥Ό μ‚¬μ©ν•λ©΄ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ°›λ” νƒ€μ…μ„ μ •μν•  μ μλ‹¤. μ λ„¤λ¦­ νƒ€μ…μ μΈμ¤ν„΄μ¤λ¥Ό λ§λ“¤λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„°λ¥Ό κµ¬μ²΄μ μΌλ΅ λ…μ‹ν•΄μ•Ό ν•λ‹¤. 

ex) List<String>, Map<String, Person>

### 9.1.1 μ λ„¤λ¦­ ν•¨μμ™€ ν”„λ΅νΌν‹°

μ λ„¤λ¦­ ν•¨μλ¥Ό μ‚¬μ©ν•λ©΄ λ¨λ“  λ¦¬μ¤νΈλ¥Ό λ‹¤λ£° μ μλ‹¤. μ λ„¤λ¦­ ν•¨μλ¥Ό νΈμ¶ν•  λ•λ” λ°λ“μ‹ νƒ€μ… μΈμλ¥Ό κµ¬μ²΄μ μΈ νƒ€μ…μΌλ΅ λ„κ²¨μ•Ό ν•λ‹¤. 

ex) Listμ slice ν•¨μ

```kotlin
fun <T> List<T>.slice(indices: IntRange): List<T>
```

ν•¨μμ νƒ€μ… νλΌλ―Έν„° Tκ°€ μμ‹  κ°μ²΄μ™€ λ°ν™ νƒ€μ…μ— μ“°μΈλ‹¤. μμ‹  κ°μ²΄μ™€ λ°ν™ νƒ€μ… λ¨λ‘ List<T>μ΄λ‹¤. μ΄λ° ν•¨μλ” λ¦¬μ¤νΈμ— λ€ν•΄ νΈμ¶ν•  λ• νƒ€μ… μΈμλ¥Ό λ…μ‹μ μΌλ΅ μ§€μ •ν•  μ μλ‹¤. 

```kotlin
val letters = ('a'..'z').toList()

println(letters.slice<Char>(0..2)) // νƒ€μ… μΈμλ¥Ό λ…μ‹μ μΌλ΅ μ§€μ •
println(letters.slice(10..13))     // μ»΄νμΌλ¬κ°€ Tκ°€ CharλΌκ³  μ¶”λ΅ ν•λ‹¤.
```

λ‘ νΈμ¶μ κ²°κ³Ό νƒ€μ…μ€ λ¨λ‘ List<Char>μ΄λ‹¤. μ»΄νμΌλ¬κ°€ λ°ν™ νƒ€μ…μ List<T>μ Tλ¥Ό Charλ΅ μΉν™ν•λ‹¤. 

### 9.1.2 μ λ„¤λ¦­ ν΄λμ¤ μ„ μ–Έ

μλ°”μ²λΌ μ½”ν‹€λ¦°μ—μ„λ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„£μ€ κΊ½μ‡  κΈ°νΈ(<>)λ¥Ό ν΄λμ¤ μ΄λ¦„ λ’¤μ— λ¶™μ΄λ©΄ ν΄λμ¤λ¥Ό μ λ„¤λ¦­ν•κ² λ§λ“¤ μ μλ‹¤. μ΄λ ‡κ² ν•λ©΄ ν•΄λ‹Ή νƒ€μ… νλΌλ―Έν„°λ¥Ό ν΄λμ¤ λ³Έλ¬Έ μ•μ—μ„ μΌλ° νƒ€μ…μ²λΌ μ‚¬μ©ν•  μ μλ‹¤. 

```kotlin
interface List<T> {
    operator fun get(index: Int): T
    // ...
}
```

μ λ„¤λ¦­ ν΄λμ¤λ¥Ό ν™•μ¥ν•λ” ν΄λμ¤λ¥Ό μ •μν•λ ¤λ©΄ κΈ°λ° νƒ€μ…μ μ λ„¤λ¦­ νλΌλ―Έν„°μ— λ€ν•΄ νƒ€μ… μΈμλ¥Ό μ§€μ •ν•΄μ•Ό ν•λ‹¤. **κµ¬μ²΄μ μΈ νƒ€μ…**μ„ λ„κΈΈ μλ„ μκ³  μ•„λ‹ **νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…**μ„ λ„κΈΈ μλ„ μλ‹¤. 

```kotlin
class StringList: List<String> {
    override fun get(index: Int): String {
        // ...
    }
}

class ArrayList<T>: List<T> {
    override fun get(index: Int): T {
        // ...
    }
}
```

ArrayList<T>μ Tλ” List<T>μ Tμ™€ λ‹¤λ¥΄λ‹¤. λ‘μ€ μ „ν€ λ‹¤λ¥Έ νƒ€μ… νλΌλ―Έν„°λΌμ„ Tκ°€ μ•„λ‹λΌ λ‹¤λ¥Έ μ΄λ¦„μ„ μ‚¬μ©ν•΄λ„ μƒκ΄€μ—†λ‹¤. 

### 9.1.3 νƒ€μ… νλΌλ―Έν„° μ μ•½

νƒ€μ… νλΌλ―Έν„° μ μ•½μ€ ν΄λμ¤λ‚ ν•¨μμ— μ‚¬μ©ν•  μ μλ” νƒ€μ… μΈμλ¥Ό μ ν•ν•λ” κΈ°λ¥μ΄λ‹¤. 

μ–΄λ–¤ νƒ€μ…μ„ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… νλΌλ―Έν„°μ— λ€ν• μƒν•μΌλ΅ μ§€μ •ν•λ©΄ κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ• μ‚¬μ©ν•λ” νƒ€μ… μΈμλ” λ°λ“μ‹ κ·Έ μƒν• νƒ€μ…μ΄κ±°λ‚ κ·Έ μƒν• νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ—¬μ•Ό ν•λ‹¤. 

μ μ•½μ„ ν•κΈ° μ„ν•΄μ„λ” νƒ€μ… νλΌλ―Έν„°μ μ΄λ¦„ λ’¤μ— μ½λ΅ (:)μ„ ν‘μ‹ν•κ³  λ’¤μ— μƒν• νƒ€μ…μ„ μ‘μ„±ν•λ©΄ λλ‹¤. 

```kotlin
fun <T: Number> oneHalf(value: T): Double {
    return value.toDouble() / 2.0
}

println(oneHalf(3.0))
// κ²°κ³Ό
// 1.5

println(oneHalf("a"))
// Type mismatch.
// Required:Number
// Found:String
```

λ§μ•½ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ λ‘ μ΄μƒμ μ μ•½μ„ κ°€ν•΄μ•Ό ν•λ” κ²½μ°μ—λ” λ‹¤λ¥Έ κµ¬λ¬Έμ„ μ‚¬μ©ν•λ‹¤. 

λ‹¤μ ν•¨μλ” λ¬Έμμ—΄μ λμ— λ§μΉ¨ν‘(.)κ°€ μ—†μΌλ©΄ μ¶”κ°€ν•λ” ν•¨μμ΄λ‹¤. μ΄ ν•¨μλ” νƒ€μ… νλΌλ―Έν„°μ— λ‘ μ΄μƒμ μ μ•½μ„ ν•΄μ•Όν•λ‹¤. 

1. λ¬Έμμ—΄μ΄μ—¬μ•Ό ν•λ‹¤.
2. append κ°€λ¥ν•΄μ•Ό ν•λ‹¤.

```kotlin
fun <T> ensureTrailingPeriod(seq: T) where T: CharSequence, T: Appendable {
    if(!seq.endsWith('.')) {
        seq.append('.')
    }
}
```

where λ’¤μ— μ μ•½ν•κ³ μ ν•λ” νƒ€μ… νλ¦¬λ―Έν„°μ νƒ€μ…μ„ λ…μ‹ν•λ©΄ λλ‹¤. 

### 9.1.4 νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ΄ λ  μ μ—†λ” νƒ€μ…μΌλ΅ ν•μ •

νƒ€μ… νλΌλ―Έν„°μ νƒ€μ…μ„ λ…μ‹ν•μ§€ μ•μΌλ©΄ μλ™μΌλ΅ Any? νƒ€μ…μΌλ΅ μ¶”λ΅ λλ‹¤. 

λ§μ•½ λ„ κ°€λ¥μ„±μ„ μ μ™Έν• μ•„λ¬΄λ° μ μ•½μ΄ ν•„μ” μ—†μΌλ©΄ νƒ€μ… νλΌλ―Έν„°μ νƒ€μ…μ„ Anyλ΅ λ…μ‹ν•λ©΄ λλ‹¤.

```kotlin
// nullable
class Processor<T> {
    fun process(value: T) {
        value?.hashCode()
    }
}

// non-nullable
class Processor<T: Any> {
    fun process(value: T) {
        value.hashCode()
    }
}
```

## 9.2 μ‹¤ν–‰ μ‹ μ λ„¤λ¦­μ¤μ λ™μ‘: μ†κ±°λ νƒ€μ… νλΌλ―Έν„°μ™€ μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°

JVMμ μ λ„¤λ¦­μ¤λ” λ³΄ν†µ νƒ€μ… μ†κ±°λ¥Ό μ‚¬μ©ν•΄ κµ¬ν„λλ‹¤. μ΄λ” μ‹¤ν–‰ μ‹μ μ— μ λ„¤λ¦­ ν΄λμ¤μ μΈμ¤ν„΄μ¤μ— νƒ€μ… μΈμ μ •λ³΄κ°€ λ“¤μ–΄μμ§€ μ•λ‹¤λ” λ»μ΄λ‹¤. ν•¨μλ¥Ό inlineμΌλ΅ λ§λ“¤λ©΄ νƒ€μ… μΈμκ°€ μ§€μ›μ§€μ§€ μ•μ„ μ μλ‹¤. 

### 9.2.1 μ‹¤ν–‰ μ‹μ μ μ λ„¤λ¦­: νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤νΈ

μ λ„¤λ¦­ ν΄λμ¤ μΈμ¤ν„΄μ¤κ°€ κ·Έ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•  λ• μ“°μΈ νƒ€μ… μΈμμ— λ€ν• μ •λ³΄λ¥Ό μ μ§€ν•μ§€ μ•λ”λ‹¤. 

ex) List<String> κ°μ²΄μ— μ—¬λ¬ λ¬Έμμ—΄μ„ λ„£μ–΄λ„ μ‹¤ν–‰ μ‹μ μ—μ„λ” μ¤μ§ List κ°μ²΄λ΅λ§ λ³Ό μ μλ‹¤. κ·Έ List κ°μ²΄κ°€ μ–΄λ–¤ νƒ€μ…μ μ›μ†λ¥Ό μ €μ¥ν•λ”μ§€ μ‹¤ν–‰ μ‹μ μ—λ” μ• μ μ—†λ‹¤. 

**νƒ€μ… μ†κ±°λ΅ μΈν•΄ μƒκΈ°λ” ν•κ³„**

μ‹¤ν–‰ μ‹μ μ—μ„ μ–΄λ–¤ κ°’μ΄ ListμΈμ§€ μ—¬λ¶€λ” μ• μ μλ‹¤. ν•μ§€λ§ ν•΄λ‹Ή Listκ°€ μ–΄λ–¤ νƒ€μ…μ μ›μ†λ“¤μ„ κ°–λ”μ§€λ” μ• μ μ—†λ‹¤. 

ν•μ§€λ§ μ΄λ° μ •λ³΄λ“¤μ΄ μ§€μ›μ§μΌλ΅μ¨ λ©”λ¨λ¦¬ μ‚¬μ©λ‰μ΄ μ¤„μ–΄λ“λ” μ¥μ μ΄ μλ‹¤. 

**μ¤νƒ€ ν”„λ΅μ μ…**

μ½”ν‹€λ¦°μ—μ„λ” νƒ€μ… μΈμλ¥Ό λ…μ‹ν•μ§€ μ•κ³  μ λ„¤λ¦­μ„ μ‚¬μ©ν•  μ μ—†λ‹¤. κ·Όλ° μ¤νƒ€ ν”„λ΅μ μ…μ„ μ‚¬μ©ν•λ©΄ μΈμλ¥Ό μ• μ μ—†λ” μ λ„¤λ¦­ νƒ€μ…μ„ ν‘ν„ν•  μ μλ‹¤. 

```kotlin
// ex) μ›μ† νƒ€μ…μ„ μ• μ μ—†λ” λ¦¬μ¤νΈ
List<*>
```

asλ‚ as? μΊμ¤ν…μ„ ν•΄λ„ μ λ„¤λ¦­ νƒ€μ…μ„ μ‚¬μ©ν•  μ μλ‹¤. 

μ‹¤ν–‰ μ‹μ μ—μ„λ” μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμ κ°’μ„ μ• μ μ—†κΈ° λ•λ¬Έμ— μΊμ¤ν…μ€ ν•­μƒ μ„±κ³µν•λ‹¤. μ΄λ° νƒ€μ… μΊμ¤ν…μ„ μ‚¬μ©ν•λ©΄ κ²½κ³ (κ²€μ‚¬ν•  μ μ—†λ” μΊμ¤ν…)μ΄ λ‚μ¤μ§€λ§ μ •μƒμ μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
fun printSum(c: Collection<*>) {
    val intList = c as? List<Int> // Unchecked cast: Collection<*> to List<Int> κ²½κ³  λ°μƒ
        ?: throw IllegalArgumentException("List is expected")
    println(intList.sum())
}
```

### 9.2.2 μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν• ν•¨μ μ„ μ–Έ

μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμ μ •λ³΄λ” μ‹¤ν–‰ μ‹μ μ—μ„ μ§€μ›μ§€κΈ° λ•λ¬Έμ— μ λ„¤λ¦­ ν΄λμ¤μ μΈμ¤ν„΄μ¤κ°€ μμ–΄λ„ κ·Έ μΈμ¤ν„΄μ¤λ¥Ό λ§λ“¤ λ• μ‚¬μ©λ νƒ€μ… μΈμλ¥Ό μ•μ•„λ‚Ό μ μ—†λ‹¤. μ λ„¤λ¦­ ν•¨μμ—μ„λ„ λ§μ°¬κ°€μ§€λ‹¤. 

```kotlin
fun <T> isA(value: Any) = value is T
// Cannot check for instance of erased type: T μ—λ¬ λ°μƒ
```

ν•μ§€λ§ inline ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ” μ‹¤μ²΄ν™”κ°€ λκΈ° λ•λ¬Έμ— μ‹¤ν–‰ μ‹μ μ νƒ€μ… μΈμλ¥Ό μ• μ μλ‹¤.

```kotlin
inline fun <reified T> isA(value: Any) = value is T

println(isA<String>("abc"))
println(isA<Int>(123))
println(isA<String>(123))

// μ‹¤ν–‰ κ²°κ³Ό
// true
// true
// false
```

μ„±λ¥ ν–¥μƒμ„ μ„ν•΄μ„ inline ν•¨μλ¥Ό μ‚¬μ©ν•κΈ°λ„ ν•μ§€λ§ μ„μ κ²½μ°μ²λΌ μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•κΈ° μ„ν•΄μ„ μ‚¬μ©ν•κΈ°λ„ ν•λ‹¤. ν•μ§€λ§ inline ν•¨μμ ν¬κΈ°κ°€ μ»¤μ§€λ©΄ μΆ‹μ§€ μ•κΈ° λ•λ¬Έμ— μ΄λ° κ²½μ°μ—λ” μ‹¤μ²΄ν™”λ νƒ€μ…μ— μμ΅΄ν•μ§€ μ•λ” λ¶€λ¶„μ„ μΌλ° ν•¨μλ΅ λΉΌλ” κ²ƒμ΄ μΆ‹λ‹¤.

### 9.2.3 μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ΅ ν΄λμ¤ μ°Έμ΅° λ€μ‹ 

java.lang.Class νƒ€μ… μΈμλ¥Ό νλΌλ―Έν„°λ΅ λ°›λ” APIμ— λ€ν• μ½”ν‹€λ¦° μ–΄λ‘ν„°λ¥Ό κµ¬ν„ν•λ” κ²½μ° μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μμ£Ό μ‚¬μ©ν•λ‹¤.
ex) JDKμ ServiceLoader

```kotlin
// κΈ°μ΅΄μ ServiceLoaderλ¥Ό μ‚¬μ©ν•μ—¬ μ„λΉ„μ¤ μ½λ” μ½”λ“
val serviceImpl = ServiceLoader.load(Provider.Service::class.java)

// μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„° μ‚¬μ©
inline fun <reified T> loadService(): ServiceLoader<T>? {
    return ServiceLoader.load(T::class.java) // T::classλ΅ νƒ€μ… νλΌλ―Έν„°μ ν΄λμ¤λ¥Ό κ°€μ Έμ¨λ‹¤.
}

val serviceImpl = loadService<Service>()
```

### 9.2.4 μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°μ μ μ•½

**μ‚¬μ©ν•  μ μλ” κ²½μ°**

- νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤ν…(is, !is, as, as?)
- μ½”ν‹€λ¦° λ¦¬ν”λ ‰μ… API(::class)
- μ½”ν‹€λ¦° νƒ€μ…μ— λ€μ‘ν•λ” java.lang.class μ–»λ” κ²½μ°(::class.java)
- λ‹¤λ¥Έ ν•¨μλ¥Ό νΈμ¶ν•  λ• νƒ€μ… μΈμλ΅ μ‚¬μ©

**ν•  μ μ—†λ” κ²ƒ**

- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ μΈμ¤ν„΄μ¤ μƒμ„±
- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ λ™λ° κ°μ²΄ λ©”μ„λ“ νΈμ¶ν•κΈ°
- μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ”κµ¬ν•λ” ν•¨μλ¥Ό νΈμ¶ν•λ©΄μ„ μ‹¤μ²΄ν™”ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…μ„ νƒ€μ… μΈμλ΅ λ„κΈ°κΈ°
- ν΄λμ¤, ν”„λ΅νΌν‹°, μΈλΌμΈ ν•¨μκ°€ μ•„λ‹ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ¥Ό reifiedλ΅ μ§€μ •ν•κΈ°

## 9.3 λ³€μ„±: μ λ„¤λ¦­κ³Ό ν•μ„ νƒ€μ…

λ³€μ„±μ€ List<String>κ³Ό List<Any>μ™€ κ°™μ΄ κΈ°μ € νƒ€μ…μ€ κ°™μ§€λ§ νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ μ—¬λ¬ νƒ€μ…μ΄ μ„λ΅ μ–΄λ–¤ κ΄€κ³„κ°€ μλ”μ§€ μ„¤λ…ν•λ” κ°λ…μ΄λ‹¤.

### 9.3.1 λ³€μ„±μ΄ μλ” μ΄μ : μΈμλ¥Ό ν•¨μμ— λ„κΈ°κΈ°

List<Any> νƒ€μ…μ„ μΈμλ΅ λ°›λ” ν•¨μμ— List<String>μ„ λ„κ²¨λ„ λλ‹¤κ³  μƒκ°ν•  μ μλ‹¤. String ν΄λμ¤κ°€ Any ν΄λμ¤λ¥Ό ν™•μ¥ν•κΈ° λ•λ¬Έμ΄λ‹¤. λ¦¬μ¤νΈμ μ›μ†μ— λ³€κ²½μ΄ μ—†λ” μ΅°κ±΄μ—μ„λ” μ•μ „ν•λ‹¤.

```kotlin
// MutableList<String> νƒ€μ…μ΄ μ „λ‹¬λλ©΄ λ¦¬μ¤νΈμ— Int κ°’μ΄ μ¶”κ°€λλ” λ™μ‘μ΄ μ‹¤ν–‰λμ„ μ¤λ¥ 
fun addAnswer(list: MutableList<Any>) {
    list.add(43)
}

val strings = mutableListOf("abc", "def")
addAnswer(strings)
```

### 9.3.2 ν΄λμ¤, νƒ€μ…, ν•μ„ νƒ€μ…

μ–΄λ–¤ νƒ€μ… Aμ κ°’μ΄ ν•„μ”ν• λ¨λ“  κ³³μ— μ–΄λ–¤ νƒ€μ… Bμ κ°’μ„ λ„£μ–΄λ„ λ¬Έμ κ°€ μ—†μΌλ©΄ Bλ” Aμ ν•μ„ νƒ€μ…μ΄λΌκ³  ν•λ‹¤. μƒμ„ νƒ€μ…μ€ ν•μ„ νƒ€μ…μ λ°λ€ κ°λ…μ΄λ‹¤. 

ex) Bκ°€ Aμ ν•μ„ νƒ€μ…μ΄λ©΄ Aλ” Bμ μƒμ„ νƒ€μ…μ΄λ‹¤. 

<aside>
π’΅ λ¨λ“  νƒ€μ…μ€ μμ‹ μ ν•μ„ νƒ€μ…μ΄λ‹¤.

</aside>

non-nullable νƒ€μ…μ€ nullable νƒ€μ…μ ν•μ„ νƒ€μ…μ΄λ‹¤. 

![ν•μ„ νƒ€μ… κ΄€κ³„](https://github.com/BEEEAM-J/Kotlin-In-Action/assets/107917980/f0f02f78-e873-4b7e-a8fb-499649c1808a)


μ•μ—μ„ List<Any> νƒ€μ…μ μΈμμ— List<String>νƒ€μ…μ„ λ„£μ„ μ μλ”μ§€ μ‚΄ν΄ λ³Έ μ μ΄ μλ‹¤. Stringμ€ Anyμ ν•μ„ νƒ€μ…μ΄μ§€λ§ MutableList<String>μ€ MutableList<Any>μ ν•μ„ νƒ€μ…μ΄ λ  μ μ—†λ‹¤. 

μ΄μ™€ κ°™μ΄ μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™” ν•  λ• νƒ€μ… μΈμλ΅ μ„λ΅ λ‹¤λ¥Έ νƒ€μ…μ΄ λ“¤μ–΄κ°€λ©΄ μΈμ¤ν„΄μ¤ μ‚¬μ΄μ ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ„±λ¦½λμ§€ μ•μΌλ©΄ κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ **λ¬΄κ³µλ³€**μ΄λΌκ³  ν•λ‹¤. 

μ½”ν‹€λ¦°μ List μΈν„°νμ΄μ¤λ” μ½κΈ° μ „μ© μ»¬λ ‰μ…μ΄λ‹¤. κ·Έλμ„ Aκ°€ Bμ ν•μ„ νƒ€μ…μ΄λ©΄ List<A>λ” List<B>μ ν•μ„ νƒ€μ…μ΄λ‹¤.  μ΄λ° ν΄λμ¤λ‚ μΈν„°νμ΄μ¤λ¥Ό **κ³µλ³€μ **μ΄λΌκ³  λ¶€λ¥Έλ‹¤.

![κ³µλ³€, λ¬΄κ³µλ³€](https://github.com/BEEEAM-J/Kotlin-In-Action/assets/107917980/39feb736-c90d-48c6-8992-33e0afc5afac)


### 9.3.3 κ³µλ³€μ„±: ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό μ μ§€

μ½”ν‹€λ¦°μ—μ„ μ λ„¤λ¦­ ν΄λμ¤κ°€ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ κ³µλ³€μ μ„μ„ ν‘μ‹ν•λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„° μ΄λ¦„ μ•μ— outμ„ λ„£μ–΄μ•Ό ν•λ‹¤. 

```kotlin
interface Producer<out T> {  // ν΄λμ¤κ°€ Tμ— λ€ν•΄ κ³µλ³€μ μ΄λΌλ” μλ―Έ
    fun produce(): T
}
```

ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄ ν•¨μ μ •μμ— μ‚¬μ©λ νƒ€μ… νλΌλ―Έν„°μ νƒ€μ…κ³Ό νƒ€μ… μΈμμ νƒ€μ…μ΄ μ •ν™•ν μΌμΉν•μ§€ μ•μ•„λ„ κ·Έ ν΄λμ¤μ μΈμ¤ν„΄μ¤λ¥Ό ν•¨μμ μΈμλ‚ λ°ν™ κ°’μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤. 

```kotlin
// Ex)
open class Animal {
    fun feed() { ... }
}

class Herd<T: Animal> {
    val size: Int get() = 1
    operator fun get (i: Int): T { ... }
}

fun feedAll(animals: Herd<Animal>) {
    for (i in 0 until animals.size) {
        animals[i].feed()
    }
}
```

μ„μ μ½”λ“μ—μ„ feedAll ν•¨μλ” μΈμλ΅ Herd<Animal> νƒ€μ…μ„ λ°›λ”λ‹¤. μ—¬κΈ°μ— Animal ν΄λμ¤λ¥Ό ν™•μ¥ν• Catμ΄λΌλ” ν΄λμ¤λ¥Ό Herd ν΄λμ¤μ T νƒ€μ… νλΌλ―Έν„°λ΅ κ°–λ” Herd<Cat>μ„ μ „λ‹¬ν•λ©΄ μ–΄λ–»κ² λ κΉ?

```kotlin
class Cat: Animal() {
    fun cleanLitter() { ... }
}

fun takeCareOfCats(cats: Herd<Cat>) {
    for(i in 0 until cats.size) {
        cats[i].cleanLitter()
        feedAll(cats) // Type mismatch: inferred type is Herd<Cat> but Herd<Animal> was expected
    }
}
```

Herdμ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ¬΄κ³µλ³€μ„±μΌλ΅ μ§€μ •ν–κΈ° λ•λ¬Έμ— νƒ€μ… μ—λ¬κ°€ λ°μƒν•λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤. μ„μ μ—λ¬λ¥Ό ν•΄κ²°ν•λ ¤λ©΄ Herdμ νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄ λλ‹¤. 

```kotlin
class Herd<out T: Animal> {
    ...
}
```

ν΄λμ¤ λ©¤λ²„λ¥Ό μ„ μ–Έν•  λ• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ” μ§€μ μ€ in, outμΌλ΅ λ‚λ‰λ‹¤. 

```kotlin
interface Transformer<T> {
    fun transform(t: T): T
//                   in  out
}
// νλΌλ―Έν„° νƒ€μ…μ΄ in μ„μΉ, λ°ν™ νƒ€μ…μ΄ out μ„μΉμ΄λ‹¤.
```

νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄ ν΄λμ¤ λ‚΄λ¶€μ—μ„λ” κ·Έ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•μ„ μ ν•ν•λ‹¤. κ·Έλμ„ ν΄λμ¤ νƒ€μ… νλΌλ―Έν„° μ•μ— outμ„ λ¶™μ΄λ©΄ in μ„μΉμ—μ„λ” μ‚¬μ©ν•  μ μ—†κ³  out μ„μΉμ—μ„λ§ μ‚¬μ©ν•  μ μκ² μ ν•λλ‹¤. 

### 9.3.4 λ°κ³µλ³€μ„±: λ’¤μ§‘ν ν•μ„ νƒ€μ… κ΄€κ³„

νƒ€μ… Bκ°€ νƒ€μ… Aμ ν•μ„ νƒ€μ…μΈ κ²½μ° ν΄λμ¤<A>κ°€ ν΄λμ¤<B>μ νƒ€μ…μΈ κ΄€κ³„κ°€ μ„±λ¦½ν•λ©΄ μ λ„¤λ¦­ ν΄λμ¤<T>λ” νƒ€μ… μΈμ Tμ— λ€ν•΄ λ°κ³µλ³€μ΄λ‹¤. μ¦‰ λ°κ³µλ³€μ€ ν•μ„ νƒ€μ… κ΄€κ³„κ°€ λ’¤μ§‘ν κ²ƒμ΄λ‹¤. 

![κ³µλ³€, λ°κ³µλ³€](https://github.com/BEEEAM-J/Kotlin-In-Action/assets/107917980/b1d49a3b-bf85-4b18-b007-6cb5a2f682f3)


λ°κ³µλ³€ in ν‚¤μ›λ“λ¥Ό λ¶™μ—¬μ„ μ‚¬μ©ν•κ³  κ³µλ³€μ„±κ³Ό λ°λ€λ΅ in μ„μΉμ—μ„λ§ μ‚¬μ©μ΄ κ°€λ¥ν•λ‹¤. 

ν΄λμ¤λ‚ μΈν„°νμ΄μ¤κ°€ μ–΄λ–¤ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„ κ³µλ³€μ μ΄λ©΄μ„ λ°κ³µλ³€μ μΌ μλ„ μλ‹¤. κ³ μ°¨ν•¨μλ¥Ό μΈμλ΅ λ°›λ” κ²½μ°μ΄λ‹¤. 

### 9.3.5 μ‚¬μ© μ§€μ  λ³€μ„±: νƒ€μ…μ΄ μ–ΈκΈ‰λλ” μ§€μ μ—μ„ λ³€μ„± μ§€μ •

ν΄λμ¤λ¥Ό μ„ μ–Έν•λ©΄μ„ λ³€μ„±μ„ μ§€μ •ν•λ©΄ κ·Έ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” λ¨λ“  μ¥μ†μ—μ„ λ³€μ„± μ§€μ •μκ°€ μν–¥μ„ λΌμ³μ„ νΈλ¦¬ν•λ° μ΄λ¥Ό **μ„ μ–Έ μ§€μ  λ³€μ„±**μ΄λΌ λ¶€λ¥Έλ‹¤. νƒ€μ… νλΌλ―Έν„°κ°€ μλ” νƒ€μ…μ„ μ‚¬μ©ν•  λ• λ§λ‹¤ ν•΄λ‹Ή νƒ€μ… νλΌλ―Έν„°λ¥Ό ν•μ„ λλ” μƒμ„ νƒ€μ…μΌλ΅ λ€μΉν•  μ μλ”μ§€ λ…μ‹ν•λ” κ²ƒμ€ **μ‚¬μ© μ§€μ  λ³€μ„±**μ΄λΌκ³  λ¶€λ¥Έλ‹¤. μ΄λ¥Ό μ‚¬μ©ν•λ©΄ νƒ€μ… νλΌλ―Έν„°μ λ³€μ„±μ„ μ„ μ–Έν•  μ μ—†λ” κ²½μ°μ— μ‚¬μ©λλ” μ§€μ μ—μ„ λ³€μ„±μ„ μ§€μ •ν•  μ μλ‹¤.

μ‚¬μ© μ§€μ  λ³€μ„±μ„ μ‚¬μ©ν•λ©΄ νƒ€μ… μΈμλ΅ μ‚¬μ©ν•  μ μλ” νƒ€μ…μ λ²”μ„κ°€ λ„“μ–΄μ§€λ” μ¥μ μ΄ μλ‹¤.

### 9.3.6 μ¤νƒ€ ν”„λ΅μ μ…: νƒ€μ… μΈμ λ€μ‹  * μ‚¬μ©

μ•μ—μ„ μ λ„¤λ¦­ νƒ€μ… μΈμ μ •λ³΄κ°€ μ—†μμ„ ν‘ν„ν•κΈ° μ„ν•΄ μ¤νƒ€ ν”„λ΅μ μ…μ„ μ‚¬μ©ν•λ‹¤κ³  λ§ν–λ‹¤. κ·Έλμ„ μ›μ†μ νƒ€μ…μ„ λ¨λ¥΄λ” λ¦¬μ¤νΈλ” List<*>λ΅ ν‘ν„ν•  μ μλ‹¤. 

**μ¤νƒ€ ν”„λ΅μ μ…μ μλ―Έ**

MutableList<*> β‰  MutableList<Any?>
MutableList<*>μ€ μ •ν•΄μ§„ κµ¬μ²΄μ μΈ νƒ€μ…μ„ λ‹΄μ§€λ§ μ•„μ§ μ›μ†μ νƒ€μ…μ„ λ¨λ¥Έλ‹¤λ” μλ―ΈλΌμ„ λ‹¤λ¥΄λ‹¤. 

```kotlin
val list: MutableList<Any?> = mutableListOf('a', 1, "qwe")
val chars = mutableListOf('a', 'b', 'c')
val unknownElements: MutableList<*> = 
    if (Random().nextBoolean()) list else chars
// unknownElements.add(42) // μ»΄νμΌλ¬κ°€ νΈμ¶ κΈμ§€
// Kotlin: The integer literal does not conform to the expected type Nothing
println(unknownElements.first())
```

μ„μ μ½”λ“μ—μ„ MutableList<*>λ” MutableList<out Any?>μ²λΌ λ™μ‘ν•λ‹¤. 

Any?λ” μ½”ν‹€λ¦° λ¨λ“  νƒ€μ…μ μƒμ„ νƒ€μ…μ΄κΈ° λ•λ¬Έμ— μ•μ „ν•κ² μ›μ†λ¥Ό κΊΌλ‚΄μ¬ μ μμ§€λ§ μ›μ†μ νƒ€μ…μ„ λ¨λ¥΄λ” λ¦¬μ¤νΈμ— κ°’μ„ μ¶”κ°€ν•λ” κ²ƒμ€ λ¶κ°€λ¥ν•λ‹¤.
